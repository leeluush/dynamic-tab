<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Student Grades Table ðŸ“Š</title>
    <style>
        body {
            padding: 1em;
            font-family: Arial, sans-serif;
            background-color: #f5f5f5;
            display: flex;
            flex-direction: column;
            align-items: center;
            height: 100vh;
        }

        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 0.5em;
        }

        p.description {
            text-align: center;
            margin-bottom: 1em;
            color: #555;
            max-width: 600px;
        }

        table {
            border: 1px solid #ddd;
            border-collapse: collapse;
            width: 100%;
            max-width: 800px;
            margin-top: 20px;
            background-color: #fff;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            animation: fadeIn 1s ease-in-out;
        }

        th,
        td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: center;
        }

        th {
            background-color: #f4b41a;
            color: #fff;
            cursor: pointer;
            position: relative;
        }

        th.sort-asc::after {
            content: "ðŸ”¼";
            position: absolute;
            right: 10px;
        }

        th.sort-desc::after {
            content: "ðŸ”½";
            position: absolute;
            right: 10px;
        }

        td img {
            width: 50px;
            height: 50px;
            cursor: pointer;
        }

        td img:hover::after {
            content: attr(alt);
            position: absolute;
            background-color: #333;
            color: #fff;
            padding: 5px;
            border-radius: 5px;
            top: 50px;
            left: 0;
        }

        tfoot td {
            font-weight: bold;
            background-color: #f4b41a;
            color: #fff;
        }

        @media (max-width: 600px) {
            table,
            th,
            td {
                font-size: 0.8em;
            }

            td img {
                width: 30px;
                height: 30px;
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        #searchInput {
            width: 100%;
            max-width: 800px;
            padding: 10px;
            margin-top: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        tr:hover {
            background-color: #f9f9f9;
            transition: background-color 0.3s ease-in-out;
        }

        .pagination {
            display: flex;
            justify-content: center;
            margin-top: 20px;
        }

        .pagination button {
            padding: 10px;
            margin: 0 5px;
            border: none;
            background-color: #f4b41a;
            color: #fff;
            cursor: pointer;
            border-radius: 5px;
        }

        .pagination button:hover {
            background-color: #d39c20;
        }

        .pagination button[disabled] {
            background-color: #ccc;
            cursor: not-allowed;
        }
    </style>
</head>

<body>
    <h1>Student Grades Table ðŸ“Š</h1>
    <p class="description">
        This table displays the grades of various students along with their respective colors and icons. 
        You can sort the table by clicking on the headers, filter the students by typing in the search bar, 
        and navigate through the data using pagination controls. The average grade is calculated and displayed 
        at the bottom of the table.
    </p>
    <input type="text" id="searchInput" placeholder="Search for names..">
    <table id="studentTable" aria-label="Student Grades Table">
        <!-- Table content will be generated by JavaScript -->
    </table>
    <div class="pagination" id="pagination">
        <!-- Pagination buttons will be generated by JavaScript -->
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            fetch('path/to/your/student-data.json')
                .then(response => response.json())
                .then(data => {
                    studentsData = data;
                    displayTable(studentsData);
                    setupPagination(studentsData);
                });

            const studentsData = [
                { Name: 'Leonardo', Grade: 82, Color: "blue", Icon: "icon/leonardo.png" },
                { Name: 'Donatello', Grade: 100, Color: "purple", Icon: 'icon/donatello.png' },
                { Name: 'Raphael', Grade: 45, Color: "red", Icon: 'icon/raphael.png' },
                { Name: 'Michelangelo', Grade: 53, Color: "orange", Icon: 'icon/michelangelo.png' },
                { Name: 'Splinter', Grade: 100, Color: "gray", Icon: 'icon/splinter.png' }
            ];

            let currentPage = 1;
            const rowsPerPage = 3;
            let sortDirection = {};

            function displayTable(data) {
                const table = document.getElementById('studentTable');
                table.innerHTML = '';

                // Create table header
                const thead = document.createElement('thead');
                const headerRow = document.createElement('tr');
                const keys = Object.keys(data[0]);

                keys.forEach(key => {
                    const header = document.createElement('th');
                    header.textContent = key;
                    header.addEventListener('click', () => sortTable(key, data));
                    header.setAttribute('aria-label', `Sort by ${key}`);
                    headerRow.appendChild(header);
                });

                thead.appendChild(headerRow);
                table.appendChild(thead);

                // Create table body
                const tbody = document.createElement('tbody');
                tbody.id = 'tableBody';

                const start = (currentPage - 1) * rowsPerPage;
                const end = start + rowsPerPage;
                const pageData = data.slice(start, end);

                pageData.forEach(student => {
                    const row = document.createElement('tr');

                    Object.values(student).forEach((value, index) => {
                        const cell = document.createElement('td');
                        if (index === 3) {
                            const iconImg = document.createElement('img');
                            iconImg.src = value;
                            iconImg.alt = `${student.Name}'s icon`;
                            cell.appendChild(iconImg);
                        } else {
                            cell.textContent = value;
                        }
                        row.appendChild(cell);
                    });

                    row.querySelector("td:nth-child(3)").style.backgroundColor = student.Color;
                    row.querySelector("td:nth-child(3)").style.color = "transparent";

                    tbody.appendChild(row);
                });

                table.appendChild(tbody);

                // Calculate and append average grade
                const tfoot = document.createElement('tfoot');
                const footerRow = document.createElement('tr');
                const footerData = document.createElement('td');
                footerData.textContent = 'Average Grade';
                footerData.colSpan = 2;

                const averageGradeCell = document.createElement('td');
                averageGradeCell.id = 'averageGrade';
                const averageGrade = calculateAverageGrade(data);
                averageGradeCell.textContent = averageGrade;

                footerRow.appendChild(footerData);
                footerRow.appendChild(averageGradeCell);
                tfoot.appendChild(footerRow);
                table.appendChild(tfoot);
            }

            function calculateAverageGrade(data) {
                const totalGrades = data.reduce((sum, student) => sum + student.Grade, 0);
                const averageGrade = (totalGrades / data.length).toFixed(2);
                return averageGrade;
            }

            function sortTable(column, data) {
                const columnIndex = Object.keys(data[0]).indexOf(column);
                const tableBody = document.getElementById('tableBody');
                const rows = Array.from(tableBody.rows);

                sortDirection[column] = !sortDirection[column];

                rows.sort((a, b) => {
                    const textA = a.cells[columnIndex].textContent.toLowerCase();
                    const textB = b.cells[columnIndex].textContent.toLowerCase();
                    return sortDirection[column] ? textA.localeCompare(textB) : textB.localeCompare(textA);
                });

                while (tableBody.firstChild) {
                    tableBody.removeChild(tableBody.firstChild);
                }

                rows.forEach(row => tableBody.appendChild(row));

                // Update header indicators
                updateHeaderIndicators(column);
            }

            function updateHeaderIndicators(activeColumn) {
                const headers = document.querySelectorAll('th');
                headers.forEach(header => {
                    header.classList.remove('sort-asc', 'sort-desc');
                    if (header.textContent === activeColumn) {
                        header.classList.add(sortDirection[activeColumn] ? 'sort-asc' : 'sort-desc');
                    }
                });
            }

            function filterTable() {
                const filter = document.getElementById("searchInput").value.toLowerCase();
                const rows = document.getElementById('tableBody').rows;

                Array.from(rows).forEach(row => {
                    const nameCell = row.cells[0];
                    if (nameCell) {
                        const txtValue = nameCell.textContent || nameCell.innerText;
                        row.style.display = txtValue.toLowerCase().includes(filter) ? "" : "none";
                    }
                });
            }

            function setupPagination(data) {
                const pagination = document.getElementById('pagination');
                const totalPages = Math.ceil(data.length / rowsPerPage);

                pagination.innerHTML = '';

                for (let i = 1; i <= totalPages; i++) {
                    const button = document.createElement('button');
                    button.textContent = i;
                    button.addEventListener('click', () => {
                        currentPage = i;
                        displayTable(data);
                        updatePaginationButtons();
                    });
                    pagination.appendChild(button);
                }

                updatePaginationButtons();
            }

            function updatePaginationButtons() {
                const buttons = document.querySelectorAll('.pagination button');
                buttons.forEach((button, index) => {
                    button.disabled = index + 1 === currentPage;
                });
            }

            document.getElementById("searchInput").addEventListener("input", filterTable);

            displayTable(studentsData);
            setupPagination(studentsData);
        });
    </script>
</body>

</html>
